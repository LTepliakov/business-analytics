{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.4.4", "generated_at": "2023-07-18T11:28:43.264633Z", "invocation_id": "d4b4de9c-4e20-40af-ba08-7d413da8b1ba", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-07-18T11:28:42.484610Z", "completed_at": "2023-07-18T11:28:42.489858Z"}, {"name": "execute", "started_at": "2023-07-18T11:28:42.490668Z", "completed_at": "2023-07-18T11:28:43.023512Z"}], "thread_id": "Thread-1", "execution_time": 0.5415470600128174, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"Mapping_UC_Odoo\", \"target_name\": \"dev\", \"node_id\": \"model.Mapping_UC_Odoo.lm_dbt_master_account_mapping\"} */\n\n  create view \"verticadb\".\"analytics\".\"lm_dbt_master_account_mapping__dbt_tmp\" include schema privileges as (\n    with base as\n(\nSELECT \t\t\ta1.account_nk AS UC_Account_ID_L0,\n\t\t        a1.pd_user_account_name AS UC_Account_Name_L0,\n\t\t        a1.pd_user_user_name AS UC_UserName_L0,\n\t\t        a1.pd_user_country as UC_Account_Country_L0,   -- NEW\n\t\t        a1.charging_id AS Charging_ID_L0,\n\t\t        p1.id AS Odoo_ID_L0,\n\t\t        p1.name AS Odoo_Account_Name_L0,\n\t\t        a2.account_nk AS \"UC_Account_ID_L+1\",\n\t\t        a2.pd_user_account_name AS \"Account_Name_L+1\",\n\t\t        a2.pd_user_user_name AS \"UC_UserName_L+1\",\n\t\t        a2.charging_id AS \"Charging_ID_L+1\",\n\t\t        p2.id AS \"Odoo_ID_L+1\",\n\t\t        p2.name AS \"Odoo_Account_Name_L+1\",\n\t\t        a3.account_nk AS \"UC_Account_ID_L+2\",\n\t\t        a3.pd_user_account_name AS \"UC_Account_Name_L+2\",\n\t\t        a3.pd_user_user_name AS \"UC_UserName_L+2\",\n\t\t        a3.charging_id AS \"Charging_ID_L+2\",\n\t\t        p3.id AS \"Odoo_ID_L+2\",\n\t\t        p3.name AS \"Odoo_Account_Name_L+2\",\n\t\t        a4.account_nk AS \"UC_Account_ID_L+3\",\n\t\t        a4.pd_user_account_name AS \"UC_Account_Name_L+3\",\n\t\t        a4.pd_user_user_name AS \"UC_UserName_L+3\",\n\t\t        a4.charging_id AS \"Charging_ID_L+3\",\n\t\t        p4.id AS \"Odoo_ID_L+3\",\n\t\t        p4.name AS \"Odoo_Account_Name_L+3\",\n\t\t        coalesce((p4.id)::varchar, (p3.id)::varchar, (p2.id)::varchar, (p1.id)::varchar, a4.account_nk, a3.account_nk, a2.account_nk, a1.account_nk) AS Master_Account_ID,\n\t\t        coalesce(p4.name, p3.name, p2.name, p1.name, a4.pd_user_account_name, a3.pd_user_account_name, a2.pd_user_account_name, a1.pd_user_account_name) AS Master_Account_Name,\n\t\t        CASE \tWHEN (p4.id IS NOT NULL) THEN 'Odoo_L+3'::varchar(8) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NOT NULL)) THEN 'Odoo_L+2'::varchar(8) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NOT NULL)) THEN 'Odoo_L+1'::varchar(8) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NOT NULL)) THEN 'Odoo_L0'::varchar(7) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NOT NULL)) THEN 'UC_L+3'::varchar(6) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NULL) AND (a3.account_nk IS NOT NULL)) THEN 'UC_L+2'::varchar(6) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NULL) AND (a3.account_nk IS NULL) AND (a2.account_nk IS NOT NULL)) THEN 'UC_L+1'::varchar(6) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NULL) AND (a3.account_nk IS NULL) AND (a2.account_nk IS NULL) AND (a1.account_nk IS NOT NULL)) THEN 'UC_L0'::varchar(5) \n\t\t        \t\tELSE NULL \n\t\t        END AS Master_Account_Origin,\n                coalesce(a4.account_nk,a3.account_nk,a2.account_nk) as UC_Super_Parent_ID,\n                coalesce(a4.pd_user_account_name,a3.pd_user_account_name,a2.pd_user_account_name) as UC_Super_Parent_Name,\n                coalesce(a4.pd_user_user_name,a3.pd_user_user_name,a2.pd_user_user_name) as UC_Super_Parent_Username,\n                case \twhen a2.account_nk is null then 'Main Account' else 'Sub-Account' end as Main_Sub_Flag \n FROM \t\t\t(((((((\n                \"verticadb\".\"standard\".\"dim_accounts\" as a1 -- standard.dim_accounts\n                LEFT JOIN \t\"verticadb\".\"raw\".\"odoo__res_partner\" as p1 ON ((p1.id = a1.erp_id)) -- raw.odoo__res_partner\n                ) \n                LEFT JOIN \tstandard.dim_accounts as a2 ON ((a1.parent_account_nk = a2.account_nk))\n                )\n                LEFT JOIN \traw.odoo__res_partner as p2 ON ((p2.id = a2.erp_id))\n                ) \n                LEFT JOIN \tstandard.dim_accounts as a3 ON ((a2.parent_account_nk = a3.account_nk))\n                ) \n                LEFT JOIN \traw.odoo__res_partner as p3 ON ((p3.id = a3.erp_id))\n                ) \n                LEFT JOIN \tstandard.dim_accounts as a4 ON ((a3.parent_account_nk = a4.account_nk))\n                )\n                LEFT JOIN \traw.odoo__res_partner as p4 ON ((p4.id = a4.erp_id))\n                )\n )\n select \t\t*\n\t\t\t\t, case when Charging_ID_L0 in ('20005065', '20004825', '20004828', '10004615') then '10626'\n\t\t\t\t\t   when Charging_ID_L0 in ('10005927') then '3762'\n\t\t\t\t\t   when Charging_ID_L0 in ('10005710', '10005891', '20004828', '20000163') then '4112'\n\t\t\t\t\t   when Charging_ID_L0 in ('20001516') then '3168'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000326') then '4154'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000477', '10006034') then '3525'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000297') then '3374'\n\t\t\t\t\t   when Charging_ID_L0 in ('20003684', '20005029') then '10857'\n\t\t\t\t\t   when Charging_ID_L0 in ('20002128') then '3704'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000934') then '5147'\n\t\t\t\t\t   else null \n\t\t\t\t  end as manual_odoo_id\n\t\t\t\t, case when Charging_ID_L0 in ('20005065', '20004825', '20004828', '10004615') then 'Careem Networks FZ LLC'\n\t\t\t\t \t   when Charging_ID_L0 in ('10005927') then 'Tatweer Educational Technologies Company - TETCO'\n\t\t\t\t\t   when Charging_ID_L0 in ('10005710', '10005891', '20004828', '20000163') then 'Saudi Manpower Solutions Co.'\n\t\t\t\t\t   when Charging_ID_L0 in ('20001516') then 'Azim Technical Financial Company Ltd.'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000326') then 'Takamol Holding'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000477', '10006034') then 'Al-Romansiah Resturant Co .Ltd'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000297') then 'Rawabi Majd International Company for Production and Distribution Ltd. - Al-Majd TV'\n\t\t\t\t\t   when Charging_ID_L0 in ('20003684', '20005029') then 'Food Basics Trading Company - Hamburgini'\n\t\t\t\t\t   when Charging_ID_L0 in ('20002128') then 'Aram Meem Trading Services Company - Toyou'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000934') then 'Mobile Telecommunications Company - Zain Saudi Arabia'\n\t\t\t\t\t   else null \n\t\t\t\t  end as manual_odoo_name\n from  \t\t\tbase\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"Mapping_UC_Odoo\", \"target_name\": \"dev\", \"node_id\": \"model.Mapping_UC_Odoo.lm_dbt_master_account_mapping\"} */\n\n  create view \"verticadb\".\"analytics\".\"lm_dbt_master_account_mapping__dbt_tmp\" include schema privileges as (\n    with base as\n(\nSELECT \t\t\ta1.account_nk AS UC_Account_ID_L0,\n\t\t        a1.pd_user_account_name AS UC_Account_Name_L0,\n\t\t        a1.pd_user_user_name AS UC_UserName_L0,\n\t\t        a1.pd_user_country as UC_Account_Country_L0,   -- NEW\n\t\t        a1.charging_id AS Charging_ID_L0,\n\t\t        p1.id AS Odoo_ID_L0,\n\t\t        p1.name AS Odoo_Account_Name_L0,\n\t\t        a2.account_nk AS \"UC_Account_ID_L+1\",\n\t\t        a2.pd_user_account_name AS \"Account_Name_L+1\",\n\t\t        a2.pd_user_user_name AS \"UC_UserName_L+1\",\n\t\t        a2.charging_id AS \"Charging_ID_L+1\",\n\t\t        p2.id AS \"Odoo_ID_L+1\",\n\t\t        p2.name AS \"Odoo_Account_Name_L+1\",\n\t\t        a3.account_nk AS \"UC_Account_ID_L+2\",\n\t\t        a3.pd_user_account_name AS \"UC_Account_Name_L+2\",\n\t\t        a3.pd_user_user_name AS \"UC_UserName_L+2\",\n\t\t        a3.charging_id AS \"Charging_ID_L+2\",\n\t\t        p3.id AS \"Odoo_ID_L+2\",\n\t\t        p3.name AS \"Odoo_Account_Name_L+2\",\n\t\t        a4.account_nk AS \"UC_Account_ID_L+3\",\n\t\t        a4.pd_user_account_name AS \"UC_Account_Name_L+3\",\n\t\t        a4.pd_user_user_name AS \"UC_UserName_L+3\",\n\t\t        a4.charging_id AS \"Charging_ID_L+3\",\n\t\t        p4.id AS \"Odoo_ID_L+3\",\n\t\t        p4.name AS \"Odoo_Account_Name_L+3\",\n\t\t        coalesce((p4.id)::varchar, (p3.id)::varchar, (p2.id)::varchar, (p1.id)::varchar, a4.account_nk, a3.account_nk, a2.account_nk, a1.account_nk) AS Master_Account_ID,\n\t\t        coalesce(p4.name, p3.name, p2.name, p1.name, a4.pd_user_account_name, a3.pd_user_account_name, a2.pd_user_account_name, a1.pd_user_account_name) AS Master_Account_Name,\n\t\t        CASE \tWHEN (p4.id IS NOT NULL) THEN 'Odoo_L+3'::varchar(8) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NOT NULL)) THEN 'Odoo_L+2'::varchar(8) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NOT NULL)) THEN 'Odoo_L+1'::varchar(8) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NOT NULL)) THEN 'Odoo_L0'::varchar(7) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NOT NULL)) THEN 'UC_L+3'::varchar(6) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NULL) AND (a3.account_nk IS NOT NULL)) THEN 'UC_L+2'::varchar(6) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NULL) AND (a3.account_nk IS NULL) AND (a2.account_nk IS NOT NULL)) THEN 'UC_L+1'::varchar(6) \n\t\t        \t\tWHEN ((p4.id IS NULL) AND (p3.id IS NULL) AND (p2.id IS NULL) AND (p1.id IS NULL) AND (a4.account_nk IS NULL) AND (a3.account_nk IS NULL) AND (a2.account_nk IS NULL) AND (a1.account_nk IS NOT NULL)) THEN 'UC_L0'::varchar(5) \n\t\t        \t\tELSE NULL \n\t\t        END AS Master_Account_Origin,\n                coalesce(a4.account_nk,a3.account_nk,a2.account_nk) as UC_Super_Parent_ID,\n                coalesce(a4.pd_user_account_name,a3.pd_user_account_name,a2.pd_user_account_name) as UC_Super_Parent_Name,\n                coalesce(a4.pd_user_user_name,a3.pd_user_user_name,a2.pd_user_user_name) as UC_Super_Parent_Username,\n                case \twhen a2.account_nk is null then 'Main Account' else 'Sub-Account' end as Main_Sub_Flag \n FROM \t\t\t(((((((\n                \"verticadb\".\"standard\".\"dim_accounts\" as a1 -- standard.dim_accounts\n                LEFT JOIN \t\"verticadb\".\"raw\".\"odoo__res_partner\" as p1 ON ((p1.id = a1.erp_id)) -- raw.odoo__res_partner\n                ) \n                LEFT JOIN \tstandard.dim_accounts as a2 ON ((a1.parent_account_nk = a2.account_nk))\n                )\n                LEFT JOIN \traw.odoo__res_partner as p2 ON ((p2.id = a2.erp_id))\n                ) \n                LEFT JOIN \tstandard.dim_accounts as a3 ON ((a2.parent_account_nk = a3.account_nk))\n                ) \n                LEFT JOIN \traw.odoo__res_partner as p3 ON ((p3.id = a3.erp_id))\n                ) \n                LEFT JOIN \tstandard.dim_accounts as a4 ON ((a3.parent_account_nk = a4.account_nk))\n                )\n                LEFT JOIN \traw.odoo__res_partner as p4 ON ((p4.id = a4.erp_id))\n                )\n )\n select \t\t*\n\t\t\t\t, case when Charging_ID_L0 in ('20005065', '20004825', '20004828', '10004615') then '10626'\n\t\t\t\t\t   when Charging_ID_L0 in ('10005927') then '3762'\n\t\t\t\t\t   when Charging_ID_L0 in ('10005710', '10005891', '20004828', '20000163') then '4112'\n\t\t\t\t\t   when Charging_ID_L0 in ('20001516') then '3168'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000326') then '4154'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000477', '10006034') then '3525'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000297') then '3374'\n\t\t\t\t\t   when Charging_ID_L0 in ('20003684', '20005029') then '10857'\n\t\t\t\t\t   when Charging_ID_L0 in ('20002128') then '3704'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000934') then '5147'\n\t\t\t\t\t   else null \n\t\t\t\t  end as manual_odoo_id\n\t\t\t\t, case when Charging_ID_L0 in ('20005065', '20004825', '20004828', '10004615') then 'Careem Networks FZ LLC'\n\t\t\t\t \t   when Charging_ID_L0 in ('10005927') then 'Tatweer Educational Technologies Company - TETCO'\n\t\t\t\t\t   when Charging_ID_L0 in ('10005710', '10005891', '20004828', '20000163') then 'Saudi Manpower Solutions Co.'\n\t\t\t\t\t   when Charging_ID_L0 in ('20001516') then 'Azim Technical Financial Company Ltd.'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000326') then 'Takamol Holding'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000477', '10006034') then 'Al-Romansiah Resturant Co .Ltd'\n\t\t\t\t\t   when Charging_ID_L0 in ('10000297') then 'Rawabi Majd International Company for Production and Distribution Ltd. - Al-Majd TV'\n\t\t\t\t\t   when Charging_ID_L0 in ('20003684', '20005029') then 'Food Basics Trading Company - Hamburgini'\n\t\t\t\t\t   when Charging_ID_L0 in ('20002128') then 'Aram Meem Trading Services Company - Toyou'\n\t\t\t\t\t   when Charging_ID_L0 in ('20000934') then 'Mobile Telecommunications Company - Zain Saudi Arabia'\n\t\t\t\t\t   else null \n\t\t\t\t  end as manual_odoo_name\n from  \t\t\tbase\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.Mapping_UC_Odoo.lm_dbt_master_account_mapping"}], "elapsed_time": 1.5991759300231934, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/oleg/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "no_print": false, "cache_selected_only": false, "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}