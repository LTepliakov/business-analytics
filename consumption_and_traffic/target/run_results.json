{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.4.4", "generated_at": "2023-10-29T19:27:13.267193Z", "invocation_id": "9f1cf155-a7f3-4371-a9b6-f26d8ee29cbf", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:23:45.932287Z", "completed_at": "2023-10-29T19:23:45.935528Z"}, {"name": "execute", "started_at": "2023-10-29T19:23:45.936253Z", "completed_at": "2023-10-29T19:23:47.033530Z"}], "thread_id": "Thread-1", "execution_time": 1.103604793548584, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_dim_countries\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_dim_countries__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect \t\tDISTINCT country_id , destination_country \nfrom \t\taggregate.fact_sms_traffic_operator_aggregate\nwhere \t\t1=1\n\t\t\tand destination_country is not null \n\t\t\tand country_id is not null\n\t\t\t--country_id in ('827','753')\n)\nselect \t\t*\n\t\t\t, count(destination_country) over (partition by destination_country) destination_country_cnt\nfrom \t\tbase\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_dim_countries\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_dim_countries__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect \t\tDISTINCT country_id , destination_country \nfrom \t\taggregate.fact_sms_traffic_operator_aggregate\nwhere \t\t1=1\n\t\t\tand destination_country is not null \n\t\t\tand country_id is not null\n\t\t\t--country_id in ('827','753')\n)\nselect \t\t*\n\t\t\t, count(destination_country) over (partition by destination_country) destination_country_cnt\nfrom \t\tbase\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_dim_countries"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:23:47.038817Z", "completed_at": "2023-10-29T19:23:47.042249Z"}, {"name": "execute", "started_at": "2023-10-29T19:23:47.042871Z", "completed_at": "2023-10-29T19:23:48.048422Z"}], "thread_id": "Thread-1", "execution_time": 1.0116550922393799, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_dim_operators\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_dim_operators__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect \t\tDISTINCT operator_id, operator_name  \nfrom \t\taggregate.fact_sms_traffic_operator_aggregate\nwhere \t\t1=1\n\t\t\tand operator_name is not null\n\t\t\tand operator_id is not null\n)\n, cnt as \n(\nselect \t\t*\n\t\t\t, count(operator_name) over (partition by operator_name) operator_name_cnt\n\t\t\t, count(operator_id) over (partition by operator_id) operator_id_cnt\nfrom \t\tbase\n)\nselect \t\t*\nfrom \t\tcnt\nwhere \t\toperator_name_cnt > 1\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_dim_operators\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_dim_operators__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect \t\tDISTINCT operator_id, operator_name  \nfrom \t\taggregate.fact_sms_traffic_operator_aggregate\nwhere \t\t1=1\n\t\t\tand operator_name is not null\n\t\t\tand operator_id is not null\n)\n, cnt as \n(\nselect \t\t*\n\t\t\t, count(operator_name) over (partition by operator_name) operator_name_cnt\n\t\t\t, count(operator_id) over (partition by operator_id) operator_id_cnt\nfrom \t\tbase\n)\nselect \t\t*\nfrom \t\tcnt\nwhere \t\toperator_name_cnt > 1\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_dim_operators"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:23:48.052862Z", "completed_at": "2023-10-29T19:23:48.057265Z"}, {"name": "execute", "started_at": "2023-10-29T19:23:48.057970Z", "completed_at": "2023-10-29T19:23:49.075471Z"}], "thread_id": "Thread-1", "execution_time": 1.0249450206756592, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_fact_sms_consumption_aggregate_stg\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_fact_sms_consumption_aggregate_stg__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect          *\n                , case when split_part(bundle_name,'_',2)='mb' then 'mb' else 'package' end as bundle_type\nfrom            \"verticadb\".\"aggregate\".\"fact_sms_consumption_aggregate\"\n)\nselect          *\n                , case when bundle_type = 'mb' then units else charge end as chargeable_units\nfrom            base\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_fact_sms_consumption_aggregate_stg\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_fact_sms_consumption_aggregate_stg__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect          *\n                , case when split_part(bundle_name,'_',2)='mb' then 'mb' else 'package' end as bundle_type\nfrom            \"verticadb\".\"aggregate\".\"fact_sms_consumption_aggregate\"\n)\nselect          *\n                , case when bundle_type = 'mb' then units else charge end as chargeable_units\nfrom            base\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_fact_sms_consumption_aggregate_stg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:23:49.094788Z", "completed_at": "2023-10-29T19:23:49.096677Z"}, {"name": "execute", "started_at": "2023-10-29T19:23:49.097248Z", "completed_at": "2023-10-29T19:23:50.158958Z"}], "thread_id": "Thread-1", "execution_time": 1.0663697719573975, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_networks\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_networks__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect \t\tDISTINCT network_id, network_name  \nfrom \t\taggregate.fact_sms_traffic_operator_aggregate\nwhere \t\t1=1\n\t\t\tand network_name is not null\n\t\t\tand network_id is not null\n)\n, cnt as\n(\nselect \t\t*\n\t\t\t, count(network_name) over (partition by network_name) network_name_cnt\n\t\t\t, count(network_id) over (partition by network_id) network_id_cnt\nfrom \t\tbase\n)\nselect \t\t*\nfrom \t\tcnt\n--where \t\tnetwork_id_cnt>1\n--order by \tnetwork_id\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_networks\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_networks__dbt_tmp\" include schema privileges as (\n    with base as\n(\nselect \t\tDISTINCT network_id, network_name  \nfrom \t\taggregate.fact_sms_traffic_operator_aggregate\nwhere \t\t1=1\n\t\t\tand network_name is not null\n\t\t\tand network_id is not null\n)\n, cnt as\n(\nselect \t\t*\n\t\t\t, count(network_name) over (partition by network_name) network_name_cnt\n\t\t\t, count(network_id) over (partition by network_id) network_id_cnt\nfrom \t\tbase\n)\nselect \t\t*\nfrom \t\tcnt\n--where \t\tnetwork_id_cnt>1\n--order by \tnetwork_id\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_networks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:23:50.171007Z", "completed_at": "2023-10-29T19:23:50.197686Z"}, {"name": "execute", "started_at": "2023-10-29T19:23:50.198299Z", "completed_at": "2023-10-29T19:24:12.051508Z"}], "thread_id": "Thread-1", "execution_time": 21.883121967315674, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_traffic_operator_agg\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith __dbt__cte__oy_dbt_lm_mapping as (\n\n\nselect \t\tCharging_ID_L0\n            , COALESCE(manual_odoo_id, Master_Account_ID) as Master_Account_ID\n            , COALESCE(manual_odoo_name, Master_Account_Name) as Master_Account_Name\n            , Master_Account_Origin\nfrom \t\t\"verticadb\".\"analytics\".\"lm_v_master_account_mapping\"\nwhere       Master_Account_Name <> 'migration traffic'\n)select \t\t    t.date_hour::DATE as date_nk\n                , t.charging_id\n                , lmm.Master_Account_ID\n                , lmm.Master_Account_Name\n                , t.destination_country\n                , t.operator_name\n                , t.network_name\n                , t.country_id\n                , t.operator_id\n                , t.country_id||'/'||t.operator_id||'/'||t.network_name  as cost_id\n                , t.event_status\n                , sum(t.units) as units\nfrom \t\t    \"verticadb\".\"aggregate\".\"fact_sms_traffic_operator_aggregate\" as t \n----------------\nleft join \t    __dbt__cte__oy_dbt_lm_mapping as lmm\non   \t\t\tt.charging_id = lmm.Charging_ID_L0\n----------------\nwhere\t\t    1=1\n                and t.event_status in ('FAILED','FAILED_ESME','SUCCESS_ESME')\ngroup by \t    1,2,3,4,5,6,7,8,9,10,11\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_traffic_operator_agg\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith __dbt__cte__oy_dbt_lm_mapping as (\n\n\nselect \t\tCharging_ID_L0\n            , COALESCE(manual_odoo_id, Master_Account_ID) as Master_Account_ID\n            , COALESCE(manual_odoo_name, Master_Account_Name) as Master_Account_Name\n            , Master_Account_Origin\nfrom \t\t\"verticadb\".\"analytics\".\"lm_v_master_account_mapping\"\nwhere       Master_Account_Name <> 'migration traffic'\n)select \t\t    t.date_hour::DATE as date_nk\n                , t.charging_id\n                , lmm.Master_Account_ID\n                , lmm.Master_Account_Name\n                , t.destination_country\n                , t.operator_name\n                , t.network_name\n                , t.country_id\n                , t.operator_id\n                , t.country_id||'/'||t.operator_id||'/'||t.network_name  as cost_id\n                , t.event_status\n                , sum(t.units) as units\nfrom \t\t    \"verticadb\".\"aggregate\".\"fact_sms_traffic_operator_aggregate\" as t \n----------------\nleft join \t    __dbt__cte__oy_dbt_lm_mapping as lmm\non   \t\t\tt.charging_id = lmm.Charging_ID_L0\n----------------\nwhere\t\t    1=1\n                and t.event_status in ('FAILED','FAILED_ESME','SUCCESS_ESME')\ngroup by \t    1,2,3,4,5,6,7,8,9,10,11\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_traffic_operator_agg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:24:12.057035Z", "completed_at": "2023-10-29T19:24:12.151243Z"}, {"name": "execute", "started_at": "2023-10-29T19:24:12.151900Z", "completed_at": "2023-10-29T19:26:27.802459Z"}], "thread_id": "Thread-1", "execution_time": 135.7478108406067, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_consumption_agg\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n     \n\nwith __dbt__cte__oy_dbt_lm_mapping as (\n\n\nselect \t\tCharging_ID_L0\n            , COALESCE(manual_odoo_id, Master_Account_ID) as Master_Account_ID\n            , COALESCE(manual_odoo_name, Master_Account_Name) as Master_Account_Name\n            , Master_Account_Origin\nfrom \t\t\"verticadb\".\"analytics\".\"lm_v_master_account_mapping\"\nwhere       Master_Account_Name <> 'migration traffic'\n),  __dbt__cte__oy_dbt_top40_clients as (\n\n\nselect \t\t* \nfrom \t\t\"verticadb\".\"analytics\".\"oy_dbt_sales_plans_gsheet\" --sandbox.oy_sales_plans_gsheet \nwhere\t\tNo<>3 order by No\n)select \t        LAST_DAY(ADD_MONTHS(hour_nk, -1)) + 1 as rep_month\n                , ca.event_type\n                , ca.general_ledger_code\n                , date(ca.hour_nk) as date_nk\n                , ca.account_id as charging_id\n                , da.pd_user_id\n                , da.pd_user_account_name\n                , ca.bundle_name\n                , ca.bundle_type\n                , da.pd_user_country\n                , case \twhen ca.bundle_name in ('10002202_UAE All Operators', '10002202_mb') then '9598' -- Tamara\n                        when ca.bundle_name in ('20000600_UAE All Operators') then '10168' -- Tabby\n                        when ca.account_id = 114 then '3436'\n                        else null \n                        end as manual_odoo_id\n                , case \twhen ca.bundle_name in ('10002202_UAE All Operators', '10002202_mb') then 'Tamara FZE' -- Tamara\n                        when ca.bundle_name in ('20000600_UAE All Operators') then 'Tabby FZ-LLC' -- Tabby\n                        else null \n                        end as manual_odoo_name\n                , ca.tariff\n                , lmm.Master_Account_ID\n                , lmm.Master_Account_Name\n                , lmm.Master_Account_Origin\n                , tm.hs_team\n                , tm.hs_manager\n                , tm.tcsm_manager\n                , case when sa.Account_Type is null then 'Client Account' else sa.Account_Type end as Account_Type\n                , case when top40.\"Customer Name\" is null then null else 'Top 40' end as client_rank\n                , ca.country_id\n                , ca.operator_id\n                , ca.network_name\n                , case  when ca.country_id is not null and ca.operator_id is not null and ca.network_name is not null\n                        then ca.country_id||'/'||ca.operator_id||'/'||ca.network_name\n                        else null\n                        end as cost_id\n                , ca.current_selling_rate_value as ocs_selling_rate\n                , sum(units) as units\n                , sum(charge) as charge\n                , sum(chargeable_units) as chargeable_units\n                , sum(case  when split_part(ca.bundle_name,'_',2)='mb' then charge\n                        else ca.charge*ca.current_selling_rate_value\n                        end\n                ) as Revenue_USD\nfrom \t\t\"verticadb\".\"analytics\".\"oy_dbt_fact_sms_consumption_aggregate_stg\" as ca --aggregate.fact_sms_consumption_aggregate \nleft join \t\"verticadb\".\"standard\".\"dim_accounts\" as da --standard.dim_accounts as da\non \t\t\tca.account_id = da.charging_id\n-------\nleft join \t__dbt__cte__oy_dbt_lm_mapping as lmm\non \t\t\tca.account_id = lmm.Charging_ID_L0\n-------\nleft join \t\"verticadb\".\"analytics\".\"oy_dbt_odoo_hs_team_manager_distinct\" as tm \non \t\t\ttm.odoo_id = lmm.Master_Account_ID\n-------\nleft join\t\"verticadb\".\"analytics\".\"oy_dbt_special_accounts\" as sa\non \t\t\tca.account_id = sa.charging_id\n-------\nleft join \t__dbt__cte__oy_dbt_top40_clients as top40\non \t\t\tlmm.Master_Account_ID = top40.\"Odoo ID\"\n-------\ngroup by\t1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_consumption_agg\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n     \n\nwith __dbt__cte__oy_dbt_lm_mapping as (\n\n\nselect \t\tCharging_ID_L0\n            , COALESCE(manual_odoo_id, Master_Account_ID) as Master_Account_ID\n            , COALESCE(manual_odoo_name, Master_Account_Name) as Master_Account_Name\n            , Master_Account_Origin\nfrom \t\t\"verticadb\".\"analytics\".\"lm_v_master_account_mapping\"\nwhere       Master_Account_Name <> 'migration traffic'\n),  __dbt__cte__oy_dbt_top40_clients as (\n\n\nselect \t\t* \nfrom \t\t\"verticadb\".\"analytics\".\"oy_dbt_sales_plans_gsheet\" --sandbox.oy_sales_plans_gsheet \nwhere\t\tNo<>3 order by No\n)select \t        LAST_DAY(ADD_MONTHS(hour_nk, -1)) + 1 as rep_month\n                , ca.event_type\n                , ca.general_ledger_code\n                , date(ca.hour_nk) as date_nk\n                , ca.account_id as charging_id\n                , da.pd_user_id\n                , da.pd_user_account_name\n                , ca.bundle_name\n                , ca.bundle_type\n                , da.pd_user_country\n                , case \twhen ca.bundle_name in ('10002202_UAE All Operators', '10002202_mb') then '9598' -- Tamara\n                        when ca.bundle_name in ('20000600_UAE All Operators') then '10168' -- Tabby\n                        when ca.account_id = 114 then '3436'\n                        else null \n                        end as manual_odoo_id\n                , case \twhen ca.bundle_name in ('10002202_UAE All Operators', '10002202_mb') then 'Tamara FZE' -- Tamara\n                        when ca.bundle_name in ('20000600_UAE All Operators') then 'Tabby FZ-LLC' -- Tabby\n                        else null \n                        end as manual_odoo_name\n                , ca.tariff\n                , lmm.Master_Account_ID\n                , lmm.Master_Account_Name\n                , lmm.Master_Account_Origin\n                , tm.hs_team\n                , tm.hs_manager\n                , tm.tcsm_manager\n                , case when sa.Account_Type is null then 'Client Account' else sa.Account_Type end as Account_Type\n                , case when top40.\"Customer Name\" is null then null else 'Top 40' end as client_rank\n                , ca.country_id\n                , ca.operator_id\n                , ca.network_name\n                , case  when ca.country_id is not null and ca.operator_id is not null and ca.network_name is not null\n                        then ca.country_id||'/'||ca.operator_id||'/'||ca.network_name\n                        else null\n                        end as cost_id\n                , ca.current_selling_rate_value as ocs_selling_rate\n                , sum(units) as units\n                , sum(charge) as charge\n                , sum(chargeable_units) as chargeable_units\n                , sum(case  when split_part(ca.bundle_name,'_',2)='mb' then charge\n                        else ca.charge*ca.current_selling_rate_value\n                        end\n                ) as Revenue_USD\nfrom \t\t\"verticadb\".\"analytics\".\"oy_dbt_fact_sms_consumption_aggregate_stg\" as ca --aggregate.fact_sms_consumption_aggregate \nleft join \t\"verticadb\".\"standard\".\"dim_accounts\" as da --standard.dim_accounts as da\non \t\t\tca.account_id = da.charging_id\n-------\nleft join \t__dbt__cte__oy_dbt_lm_mapping as lmm\non \t\t\tca.account_id = lmm.Charging_ID_L0\n-------\nleft join \t\"verticadb\".\"analytics\".\"oy_dbt_odoo_hs_team_manager_distinct\" as tm \non \t\t\ttm.odoo_id = lmm.Master_Account_ID\n-------\nleft join\t\"verticadb\".\"analytics\".\"oy_dbt_special_accounts\" as sa\non \t\t\tca.account_id = sa.charging_id\n-------\nleft join \t__dbt__cte__oy_dbt_top40_clients as top40\non \t\t\tlmm.Master_Account_ID = top40.\"Odoo ID\"\n-------\ngroup by\t1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_consumption_agg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:26:27.808274Z", "completed_at": "2023-10-29T19:26:27.813233Z"}, {"name": "execute", "started_at": "2023-10-29T19:26:27.813895Z", "completed_at": "2023-10-29T19:26:29.259730Z"}], "thread_id": "Thread-1", "execution_time": 1.4536688327789307, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_traffic_operator_agg_KSA\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg_KSA__dbt_tmp\" include schema privileges as (\n    \n\nwith base as\n(\nselect          *\n                , case when     (\n                                network_name ilike '%Zain%'\n                                or network_name ilike '%Mobily%'\n                                or network_name ilike '%Lebara%'\n                                or network_name ilike '%Virgin%'\n                                )\n                                --and country_id = 3 -- speak to Dayan see below why\n                                then 'KSA_only' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_name ilike '%STC%' then 'KSA_and_International' -- if country_id is essential for alledgedly KSA networks only then I need ti uncomment country_id = 3 clause for them\n                       when     network_name is null then 'Unknown'\n                       else     'International'\n                       end as network_is\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg\"\n)\n, cats as\n(\nselect          *\n                , case when     network_is = 'KSA_only' then 'KSA' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_is = 'KSA_and_International' and country_id = 3 then 'KSA'\n                       when     network_is = 'Unknown' then 'Unknown'\n                       else 'International'\n                       end as traffic_is\n                , case when cost_id is null then 'Unknown'\n                       else 'Known'\n                       end as cost_id_is\nfrom            base\n)\nselect \t\t    *\nfrom \t\t    cats\n----------------\nwhere\t\t    1=1\n                and network_name not ilike 'Internal%'\n                and traffic_is = 'KSA'\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_traffic_operator_agg_KSA\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg_KSA__dbt_tmp\" include schema privileges as (\n    \n\nwith base as\n(\nselect          *\n                , case when     (\n                                network_name ilike '%Zain%'\n                                or network_name ilike '%Mobily%'\n                                or network_name ilike '%Lebara%'\n                                or network_name ilike '%Virgin%'\n                                )\n                                --and country_id = 3 -- speak to Dayan see below why\n                                then 'KSA_only' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_name ilike '%STC%' then 'KSA_and_International' -- if country_id is essential for alledgedly KSA networks only then I need ti uncomment country_id = 3 clause for them\n                       when     network_name is null then 'Unknown'\n                       else     'International'\n                       end as network_is\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg\"\n)\n, cats as\n(\nselect          *\n                , case when     network_is = 'KSA_only' then 'KSA' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_is = 'KSA_and_International' and country_id = 3 then 'KSA'\n                       when     network_is = 'Unknown' then 'Unknown'\n                       else 'International'\n                       end as traffic_is\n                , case when cost_id is null then 'Unknown'\n                       else 'Known'\n                       end as cost_id_is\nfrom            base\n)\nselect \t\t    *\nfrom \t\t    cats\n----------------\nwhere\t\t    1=1\n                and network_name not ilike 'Internal%'\n                and traffic_is = 'KSA'\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_traffic_operator_agg_KSA"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:26:29.264987Z", "completed_at": "2023-10-29T19:26:29.269171Z"}, {"name": "execute", "started_at": "2023-10-29T19:26:29.269813Z", "completed_at": "2023-10-29T19:26:58.967127Z"}], "thread_id": "Thread-1", "execution_time": 29.704530000686646, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_consumption_agg_sms\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg_sms__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n     \n\nwith base as\n(\nselect          *\n                , case when     (\n                                network_name ilike '%Zain%'\n                                or network_name ilike '%Mobily%'\n                                or network_name ilike '%Lebara%'\n                                or network_name ilike '%Virgin%'\n                                )\n                                --and country_id = 3 -- speak to Dayan see below why\n                                then 'KSA_only' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_name ilike '%STC%' then 'KSA_and_International' -- if country_id is essential for alledgedly KSA networks only then I need ti uncomment country_id = 3 clause for them\n                       when     network_name is null then 'Unknown'\n                       else     'International'\n                       end as network_is\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg\"\nwhere           1=1\n                and     (\n                        event_type = 'default.sms' \n                        or general_ledger_code='Forfeiture Of Package Balance'\n                        )\n                and date_nk >= '2023-01-01'\n                --and Account_Type in ('Client Account - Open', 'Client Account')\n)\n, cats as\n(\nselect          *\n                , case when     network_is = 'KSA_only' then 'KSA' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_is = 'KSA_and_International' and country_id = 3 then 'KSA'\n                       when     network_is = 'Unknown' then 'Unknown'\n                       else 'International'\n                       end as traffic_is\n                , case when cost_id is null then 'Unknown'\n                       else 'Known'\n                       end as cost_id_is\nfrom            base\n)\n, charge_with_cats as\n(\nselect          *\n                , sum(units) over (partition by Master_Account_Name) as client_charge\n                , case when traffic_is = 'Unknown' then 0 \n                       else units\n                       end as 'categorized_charge'\n                , case when cost_id_is ='Unknown' then 0 \n                \t   else units\n                       end as 'charge_with_cost_id'\nfrom            cats\n)\n, totals as\n(\nselect          *\n                , sum(categorized_charge) over (partition by Master_Account_Name) as categorized_charge_agg\n                , sum(charge_with_cost_id) over (partition by Master_Account_Name) as charge_with_cost_id_agg\nfrom            charge_with_cats\n)\nselect          *\n                , case when client_charge = 0 then null else round(100*(categorized_charge_agg/client_charge),1) end as categorized_charge_pct\n                , case when client_charge = 0 then null else round(100*(charge_with_cost_id_agg/client_charge),1) end as charge_with_cost_id_pct\nfrom            totals\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_consumption_agg_sms\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg_sms__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n     \n\nwith base as\n(\nselect          *\n                , case when     (\n                                network_name ilike '%Zain%'\n                                or network_name ilike '%Mobily%'\n                                or network_name ilike '%Lebara%'\n                                or network_name ilike '%Virgin%'\n                                )\n                                --and country_id = 3 -- speak to Dayan see below why\n                                then 'KSA_only' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_name ilike '%STC%' then 'KSA_and_International' -- if country_id is essential for alledgedly KSA networks only then I need ti uncomment country_id = 3 clause for them\n                       when     network_name is null then 'Unknown'\n                       else     'International'\n                       end as network_is\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg\"\nwhere           1=1\n                and     (\n                        event_type = 'default.sms' \n                        or general_ledger_code='Forfeiture Of Package Balance'\n                        )\n                and date_nk >= '2023-01-01'\n                --and Account_Type in ('Client Account - Open', 'Client Account')\n)\n, cats as\n(\nselect          *\n                , case when     network_is = 'KSA_only' then 'KSA' -- ask Dayana about the super rare use cases for these operator whne country_id <> 3. Why?\n                       when     network_is = 'KSA_and_International' and country_id = 3 then 'KSA'\n                       when     network_is = 'Unknown' then 'Unknown'\n                       else 'International'\n                       end as traffic_is\n                , case when cost_id is null then 'Unknown'\n                       else 'Known'\n                       end as cost_id_is\nfrom            base\n)\n, charge_with_cats as\n(\nselect          *\n                , sum(units) over (partition by Master_Account_Name) as client_charge\n                , case when traffic_is = 'Unknown' then 0 \n                       else units\n                       end as 'categorized_charge'\n                , case when cost_id_is ='Unknown' then 0 \n                \t   else units\n                       end as 'charge_with_cost_id'\nfrom            cats\n)\n, totals as\n(\nselect          *\n                , sum(categorized_charge) over (partition by Master_Account_Name) as categorized_charge_agg\n                , sum(charge_with_cost_id) over (partition by Master_Account_Name) as charge_with_cost_id_agg\nfrom            charge_with_cats\n)\nselect          *\n                , case when client_charge = 0 then null else round(100*(categorized_charge_agg/client_charge),1) end as categorized_charge_pct\n                , case when client_charge = 0 then null else round(100*(charge_with_cost_id_agg/client_charge),1) end as charge_with_cost_id_pct\nfrom            totals\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_consumption_agg_sms"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:26:58.973547Z", "completed_at": "2023-10-29T19:26:58.978071Z"}, {"name": "execute", "started_at": "2023-10-29T19:26:58.978744Z", "completed_at": "2023-10-29T19:27:12.737300Z"}], "thread_id": "Thread-1", "execution_time": 13.766252994537354, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_consumption_agg_sms_KSA\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg_sms_KSA__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n     \n\nwith base as\n(\nselect          *\n\t\t\t\t, case when bundle_type = 'mb' then charge/units else null \n                       end as mb_sell_rate_USD\n\t\t\t\t, case when ocs_selling_rate >= 0.1 or ocs_selling_rate = 0\n\t\t\t\t\t   then null\n\t\t\t\t\t   else ocs_selling_rate\n\t\t\t\t\t   end as package_sell_rate_USD\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg_sms\" \nwhere \t\t\t1=1\n\t\t\t\tand units <> 0\n)\n, stg as\n(\nselect \t\t\t*\n\t\t\t\t, case \twhen bundle_type = 'mb' then mb_sell_rate_USD\n\t\t\t\t\t\telse package_sell_rate_USD\n\t\t\t\t\t\tend as current_selling_rate_value\nfrom \t\t\tbase\n)\nselect          c.*\n                , p.price as cost_rate\n                , p.currency\n                , p.cost_rate_USD\n                , 100*(c.current_selling_rate_value/p.cost_rate_USD -1) as GM_pct_estimate\n                , c.Revenue_USD*(c.current_selling_rate_value/p.cost_rate_USD -1) as GP_USD_estimate\nfrom            stg as c\nleft join \t    \"verticadb\".\"analytics\".\"oy_dbt_cost_update_Dyana_B\" as p\non \t\t\t    c.cost_id = p.cost_id\n                and c.date_nk >= p.effective_from \n                and c.date_nk < p.effective_to_var\nwhere           traffic_is in ('KSA', 'Unknown') -- Include unknow because of Alinma Bank use case which might contain failed campaigns traffic or can be a DQ issue\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"consumption_and_traffic\", \"target_name\": \"dev\", \"node_id\": \"model.consumption_and_traffic.oy_dbt_consumption_agg_sms_KSA\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg_sms_KSA__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n     \n\nwith base as\n(\nselect          *\n\t\t\t\t, case when bundle_type = 'mb' then charge/units else null \n                       end as mb_sell_rate_USD\n\t\t\t\t, case when ocs_selling_rate >= 0.1 or ocs_selling_rate = 0\n\t\t\t\t\t   then null\n\t\t\t\t\t   else ocs_selling_rate\n\t\t\t\t\t   end as package_sell_rate_USD\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg_sms\" \nwhere \t\t\t1=1\n\t\t\t\tand units <> 0\n)\n, stg as\n(\nselect \t\t\t*\n\t\t\t\t, case \twhen bundle_type = 'mb' then mb_sell_rate_USD\n\t\t\t\t\t\telse package_sell_rate_USD\n\t\t\t\t\t\tend as current_selling_rate_value\nfrom \t\t\tbase\n)\nselect          c.*\n                , p.price as cost_rate\n                , p.currency\n                , p.cost_rate_USD\n                , 100*(c.current_selling_rate_value/p.cost_rate_USD -1) as GM_pct_estimate\n                , c.Revenue_USD*(c.current_selling_rate_value/p.cost_rate_USD -1) as GP_USD_estimate\nfrom            stg as c\nleft join \t    \"verticadb\".\"analytics\".\"oy_dbt_cost_update_Dyana_B\" as p\non \t\t\t    c.cost_id = p.cost_id\n                and c.date_nk >= p.effective_from \n                and c.date_nk < p.effective_to_var\nwhere           traffic_is in ('KSA', 'Unknown') -- Include unknow because of Alinma Bank use case which might contain failed campaigns traffic or can be a DQ issue\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.consumption_and_traffic.oy_dbt_consumption_agg_sms_KSA"}], "elapsed_time": 209.60016107559204, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/oleg/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "no_print": false, "cache_selected_only": false, "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}