{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.4.4", "generated_at": "2023-11-02T06:49:23.920273Z", "invocation_id": "ad07dc15-432f-42e8-a7d2-2549abeb3578", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-02T06:47:37.829230Z", "completed_at": "2023-11-02T06:47:37.834968Z"}, {"name": "execute", "started_at": "2023-11-02T06:47:37.835841Z", "completed_at": "2023-11-02T06:47:39.104189Z"}], "thread_id": "Thread-1", "execution_time": 1.277541160583496, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_campaigns\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_conversation_campaigns__dbt_tmp\" include schema privileges as (\n    select \t\t    fc.*\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.pd_user_user_name \n                , da.pd_user_account_name\nfrom \t\t    \"verticadb\".\"aggregate\".\"fact_campaigns\" as fc\n----------------\nleft join\t    \"verticadb\".\"standard\".\"dim_accounts\" as da\non \t\t\t    fc.account_id = da.account_nk\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    fc.account_id =lm.UC_Account_ID_L0\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_campaigns\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_conversation_campaigns__dbt_tmp\" include schema privileges as (\n    select \t\t    fc.*\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.pd_user_user_name \n                , da.pd_user_account_name\nfrom \t\t    \"verticadb\".\"aggregate\".\"fact_campaigns\" as fc\n----------------\nleft join\t    \"verticadb\".\"standard\".\"dim_accounts\" as da\non \t\t\t    fc.account_id = da.account_nk\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    fc.account_id =lm.UC_Account_ID_L0\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_conversation_campaigns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-02T06:47:39.119612Z", "completed_at": "2023-11-02T06:47:39.125308Z"}, {"name": "execute", "started_at": "2023-11-02T06:47:39.125988Z", "completed_at": "2023-11-02T06:47:47.788963Z"}], "thread_id": "Thread-1", "execution_time": 8.671689987182617, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_wtsap_cost_and_conversations\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_conversation_wtsap_cost_and_conversations__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith da as \n(\nselect  \t    account_nk as Account_ID\n                , pd_user_user_name as Username\n                , split_part(pd_user_user_name,'@',2) as Account_Domain\n                , pd_user_account_name as Account_Name  \nfrom \t\t    \"verticadb\".\"standard\".\"dim_accounts\"\n)\nselect \t\t\twc.* \n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.Username \n                , da.Account_Domain \n                , da.Account_Name\nfrom \t\t\t\"verticadb\".\"raw\".\"conversation__whatsapp_conversation_based_charge\" as wc\n----------------\nleft join\t\tda\non \t\t\t\twc.account_id = da.Account_ID\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    wc.account_id = lm.UC_Account_ID_L0\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_wtsap_cost_and_conversations\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_conversation_wtsap_cost_and_conversations__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith da as \n(\nselect  \t    account_nk as Account_ID\n                , pd_user_user_name as Username\n                , split_part(pd_user_user_name,'@',2) as Account_Domain\n                , pd_user_account_name as Account_Name  \nfrom \t\t    \"verticadb\".\"standard\".\"dim_accounts\"\n)\nselect \t\t\twc.* \n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.Username \n                , da.Account_Domain \n                , da.Account_Name\nfrom \t\t\t\"verticadb\".\"raw\".\"conversation__whatsapp_conversation_based_charge\" as wc\n----------------\nleft join\t\tda\non \t\t\t\twc.account_id = da.Account_ID\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    wc.account_id = lm.UC_Account_ID_L0\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_conversation_wtsap_cost_and_conversations"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-02T06:47:47.794482Z", "completed_at": "2023-11-02T06:47:47.810585Z"}, {"name": "execute", "started_at": "2023-11-02T06:47:47.811237Z", "completed_at": "2023-11-02T06:49:19.511070Z"}], "thread_id": "Thread-1", "execution_time": 91.71866965293884, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_messages\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_conversation_messages__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith __dbt__cte__oy_dbt_conversation_messages_append as (\n\n\nSELECT  \t      date(fc.created_at) AS Creation_Date\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , fc.account_id\n                , da.pd_user_account_name as Account_Name\n                , da.pd_user_user_name as Username\n                , split_part(da.pd_user_user_name,'@',2) as Account_Domain\n                --, fc.end_customer_contact as End_User\n                , CASE fc.channel\t  WHEN 'whatsapp' THEN 'WHATSAPP'     \n                                    WHEN 'messenger' THEN 'MESSENGER'     \n                                    WHEN 'twitter' THEN 'TWITTER'     \n                                    else fc.channel \n                  END as Channel\n                , CASE fc.content_type WHEN 'TEMPLATE' THEN 'TEMPLATE' ELSE 'SESSION' END AS message_type\n                , fc.comm_direction AS Direction\n                , fc.product\n                , nvl(COUNT(fc.record_id), 0) AS Message_Count\n                , count(distinct fc.end_customer_contact) as End_User\nfrom \t\t        \"verticadb\".\"standard\".\"fact_conversation\" as fc \n----------------\nleft join \t    \"verticadb\".\"standard\".\"dim_accounts\" as da \non \t\t\t        fc.account_id =da.account_nk  \n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t        fc.account_id =lm.UC_Account_ID_L0\n----------------\nwhere \t\t      year(fc.created_at) = 2023\n                and month(created_at) > 9\n----------------\ngroup by  \t    1,2,3,4,5,6,7,8,9,10,11\n)select * from \"verticadb\".\"analytics\".\"oy_conversation_messages_2023_H1\"\nunion\nselect * from \"verticadb\".\"analytics\".\"oy_conversation_messages_2023_Q3\"\nunion\nselect * from __dbt__cte__oy_dbt_conversation_messages_append\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_messages\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_conversation_messages__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith __dbt__cte__oy_dbt_conversation_messages_append as (\n\n\nSELECT  \t      date(fc.created_at) AS Creation_Date\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , fc.account_id\n                , da.pd_user_account_name as Account_Name\n                , da.pd_user_user_name as Username\n                , split_part(da.pd_user_user_name,'@',2) as Account_Domain\n                --, fc.end_customer_contact as End_User\n                , CASE fc.channel\t  WHEN 'whatsapp' THEN 'WHATSAPP'     \n                                    WHEN 'messenger' THEN 'MESSENGER'     \n                                    WHEN 'twitter' THEN 'TWITTER'     \n                                    else fc.channel \n                  END as Channel\n                , CASE fc.content_type WHEN 'TEMPLATE' THEN 'TEMPLATE' ELSE 'SESSION' END AS message_type\n                , fc.comm_direction AS Direction\n                , fc.product\n                , nvl(COUNT(fc.record_id), 0) AS Message_Count\n                , count(distinct fc.end_customer_contact) as End_User\nfrom \t\t        \"verticadb\".\"standard\".\"fact_conversation\" as fc \n----------------\nleft join \t    \"verticadb\".\"standard\".\"dim_accounts\" as da \non \t\t\t        fc.account_id =da.account_nk  \n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t        fc.account_id =lm.UC_Account_ID_L0\n----------------\nwhere \t\t      year(fc.created_at) = 2023\n                and month(created_at) > 9\n----------------\ngroup by  \t    1,2,3,4,5,6,7,8,9,10,11\n)select * from \"verticadb\".\"analytics\".\"oy_conversation_messages_2023_H1\"\nunion\nselect * from \"verticadb\".\"analytics\".\"oy_conversation_messages_2023_Q3\"\nunion\nselect * from __dbt__cte__oy_dbt_conversation_messages_append\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_conversation_messages"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-02T06:49:19.515927Z", "completed_at": "2023-11-02T06:49:19.524013Z"}, {"name": "execute", "started_at": "2023-11-02T06:49:19.524709Z", "completed_at": "2023-11-02T06:49:21.884757Z"}], "thread_id": "Thread-1", "execution_time": 2.3712799549102783, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_WA_active_businesses_current\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_WA_active_businesses_current__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\n\n\n\t(\n\twith active_clients_at as\n\t(\n\tselect \t\t\twab_id\n\t\t\t\t\t, conversation_direction\n\t\t\t\t\t, conversation_start::DATE as conversation_start\n\t\t\t\t\t, GETDATE()::DATE - 0 - 1 as report_date\n\t\t\t\t\t, DATEDIFF(day, created_at::DATE, GETDATE()::DATE - 0 - 1) as days_since_last_convers\n\t                , Master_Account_Name\n\t                , Master_Account_ID\n\t                , Username \n\t                , Account_Domain \n\t                , Account_Name\n\tfrom \t\t\t\"verticadb\".\"analytics\".\"oy_dbt_conversation_wtsap_cost_and_conversations\"\n\twhere \t\t\t1=1\n\t\t\t\t\tand days_since_last_convers <= 30\n\t\t\t\t\tand days_since_last_convers >= 0\n\t\t\t\t\tand conversation_start::DATE>'2023-07-30'\n\t)\n\tselect \t\t\twab_id\n\t\t\t\t\t, conversation_direction\n\t\t\t\t\t, report_date\n\t                , Master_Account_Name\n\t                , Master_Account_ID\n\t                , Username \n\t                , Account_Domain \n\t                , Account_Name\n\t\t\t\t\t, max(conversation_start) as last_convers_at\n\t\t\t\t\t, min(days_since_last_convers) as days_since_last_convers\n\tfrom \t\t\tactive_clients_at\n\tgroup by \t\t1,2,3,4,5,6,7,8\n\t)\n\t----------------\n\t\n\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_WA_active_businesses_current\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_WA_active_businesses_current__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\n\n\n\t(\n\twith active_clients_at as\n\t(\n\tselect \t\t\twab_id\n\t\t\t\t\t, conversation_direction\n\t\t\t\t\t, conversation_start::DATE as conversation_start\n\t\t\t\t\t, GETDATE()::DATE - 0 - 1 as report_date\n\t\t\t\t\t, DATEDIFF(day, created_at::DATE, GETDATE()::DATE - 0 - 1) as days_since_last_convers\n\t                , Master_Account_Name\n\t                , Master_Account_ID\n\t                , Username \n\t                , Account_Domain \n\t                , Account_Name\n\tfrom \t\t\t\"verticadb\".\"analytics\".\"oy_dbt_conversation_wtsap_cost_and_conversations\"\n\twhere \t\t\t1=1\n\t\t\t\t\tand days_since_last_convers <= 30\n\t\t\t\t\tand days_since_last_convers >= 0\n\t\t\t\t\tand conversation_start::DATE>'2023-07-30'\n\t)\n\tselect \t\t\twab_id\n\t\t\t\t\t, conversation_direction\n\t\t\t\t\t, report_date\n\t                , Master_Account_Name\n\t                , Master_Account_ID\n\t                , Username \n\t                , Account_Domain \n\t                , Account_Name\n\t\t\t\t\t, max(conversation_start) as last_convers_at\n\t\t\t\t\t, min(days_since_last_convers) as days_since_last_convers\n\tfrom \t\t\tactive_clients_at\n\tgroup by \t\t1,2,3,4,5,6,7,8\n\t)\n\t----------------\n\t\n\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_WA_active_businesses_current"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-02T06:49:21.890796Z", "completed_at": "2023-11-02T06:49:21.897333Z"}, {"name": "execute", "started_at": "2023-11-02T06:49:21.898139Z", "completed_at": "2023-11-02T06:49:23.350054Z"}], "thread_id": "Thread-1", "execution_time": 1.461622953414917, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_WA_active_businesses\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_WA_active_businesses__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nselect * from \"verticadb\".\"analytics\".\"oy_dbt_WA_active_businesses_current\"\nunion\nselect * from analytics.oy_dbt_oy_dbt_WA_active_businesses_Sep\nunion\nselect * from analytics.oy_dbt_oy_dbt_WA_active_businesses_Oct\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_WA_active_businesses\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_WA_active_businesses__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nselect * from \"verticadb\".\"analytics\".\"oy_dbt_WA_active_businesses_current\"\nunion\nselect * from analytics.oy_dbt_oy_dbt_WA_active_businesses_Sep\nunion\nselect * from analytics.oy_dbt_oy_dbt_WA_active_businesses_Oct\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_WA_active_businesses"}], "elapsed_time": 108.36579608917236, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/oleg/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "no_print": false, "cache_selected_only": false, "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}