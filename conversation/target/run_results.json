{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.4.4", "generated_at": "2023-09-11T17:21:38.820701Z", "invocation_id": "f6365f2c-953d-4088-8d41-2a42e30e8fff", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-09-11T17:19:39.218899Z", "completed_at": "2023-09-11T17:19:39.223496Z"}, {"name": "execute", "started_at": "2023-09-11T17:19:39.224385Z", "completed_at": "2023-09-11T17:19:47.145096Z"}], "thread_id": "Thread-1", "execution_time": 7.9286909103393555, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_campaigns\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_conversation_campaigns__dbt_tmp\" include schema privileges as (\n    select \t\t    fc.*\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.pd_user_user_name \n                , da.pd_user_account_name\nfrom \t\t    \"verticadb\".\"aggregate\".\"fact_campaigns\" as fc\n----------------\nleft join\t    \"verticadb\".\"standard\".\"dim_accounts\" as da\non \t\t\t    fc.account_id = da.account_nk\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    fc.account_id =lm.UC_Account_ID_L0\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_campaigns\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_conversation_campaigns__dbt_tmp\" include schema privileges as (\n    select \t\t    fc.*\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.pd_user_user_name \n                , da.pd_user_account_name\nfrom \t\t    \"verticadb\".\"aggregate\".\"fact_campaigns\" as fc\n----------------\nleft join\t    \"verticadb\".\"standard\".\"dim_accounts\" as da\non \t\t\t    fc.account_id = da.account_nk\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    fc.account_id =lm.UC_Account_ID_L0\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_conversation_campaigns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-09-11T17:19:47.159495Z", "completed_at": "2023-09-11T17:19:47.164608Z"}, {"name": "execute", "started_at": "2023-09-11T17:19:47.165315Z", "completed_at": "2023-09-11T17:19:52.564608Z"}], "thread_id": "Thread-1", "execution_time": 5.407508850097656, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_wtsap_cost_and_conversations\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_conversation_wtsap_cost_and_conversations__dbt_tmp\" include schema privileges as (\n    \n\nwith da as \n(\nselect  \t    account_nk as Account_ID\n                , pd_user_user_name as Username\n                , split_part(pd_user_user_name,'@',2) as Account_Domain\n                , pd_user_account_name as Account_Name  \nfrom \t\t    \"verticadb\".\"standard\".\"dim_accounts\"\n)\nselect \t\t\twc.* \n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.Username \n                , da.Account_Domain \n                , da.Account_Name\nfrom \t\t\t\"verticadb\".\"raw\".\"conversation__whatsapp_conversation_based_charge\" as wc\n----------------\nleft join\t\tda\non \t\t\t\twc.account_id = da.Account_ID\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    wc.account_id = lm.UC_Account_ID_L0\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_wtsap_cost_and_conversations\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_conversation_wtsap_cost_and_conversations__dbt_tmp\" include schema privileges as (\n    \n\nwith da as \n(\nselect  \t    account_nk as Account_ID\n                , pd_user_user_name as Username\n                , split_part(pd_user_user_name,'@',2) as Account_Domain\n                , pd_user_account_name as Account_Name  \nfrom \t\t    \"verticadb\".\"standard\".\"dim_accounts\"\n)\nselect \t\t\twc.* \n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , da.Username \n                , da.Account_Domain \n                , da.Account_Name\nfrom \t\t\t\"verticadb\".\"raw\".\"conversation__whatsapp_conversation_based_charge\" as wc\n----------------\nleft join\t\tda\non \t\t\t\twc.account_id = da.Account_ID\n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t    wc.account_id = lm.UC_Account_ID_L0\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_conversation_wtsap_cost_and_conversations"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-09-11T17:19:52.570012Z", "completed_at": "2023-09-11T17:19:52.584107Z"}, {"name": "execute", "started_at": "2023-09-11T17:19:52.584761Z", "completed_at": "2023-09-11T17:21:35.671707Z"}], "thread_id": "Thread-1", "execution_time": 103.10407590866089, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_messages\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_conversation_messages__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith __dbt__cte__oy_dbt_conversation_messages_append as (\n\n\nSELECT  \t      date(fc.created_at) AS Creation_Date\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , fc.account_id\n                , da.pd_user_account_name as Account_Name\n                , da.pd_user_user_name as Username\n                , split_part(da.pd_user_user_name,'@',2) as Account_Domain\n                --, fc.end_customer_contact as End_User\n                , CASE fc.channel\t  WHEN 'whatsapp' THEN 'WHATSAPP'     \n                                    WHEN 'messenger' THEN 'MESSENGER'     \n                                    WHEN 'twitter' THEN 'TWITTER'     \n                                    else fc.channel \n                  END as Channel\n                , CASE fc.content_type WHEN 'TEMPLATE' THEN 'TEMPLATE' ELSE 'SESSION' END AS message_type\n                , fc.comm_direction AS Direction\n                , fc.product\n                , nvl(COUNT(fc.record_id), 0) AS Message_Count\n                , count(distinct fc.end_customer_contact) as End_User\nfrom \t\t        \"verticadb\".\"standard\".\"fact_conversation\" as fc \n----------------\nleft join \t    \"verticadb\".\"standard\".\"dim_accounts\" as da \non \t\t\t        fc.account_id =da.account_nk  \n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t        fc.account_id =lm.UC_Account_ID_L0\n----------------\nwhere \t\t      year(fc.created_at) = 2023\n                and month(created_at) > 6\n----------------\ngroup by  \t    1,2,3,4,5,6,7,8,9,10,11\n)select * from \"verticadb\".\"analytics\".\"oy_conversation_messages_2023_H1\"\nunion\nselect * from __dbt__cte__oy_dbt_conversation_messages_append\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"conversation\", \"target_name\": \"dev\", \"node_id\": \"model.conversation.oy_dbt_conversation_messages\"} */\n\n  \n    create  table\n    \"verticadb\".\"analytics\".\"oy_dbt_conversation_messages__dbt_tmp\"\n    \n    INCLUDE SCHEMA PRIVILEGES as (\n    \n\nwith __dbt__cte__oy_dbt_conversation_messages_append as (\n\n\nSELECT  \t      date(fc.created_at) AS Creation_Date\n                , lm.Master_Account_Name\n                , lm.Master_Account_ID\n                , fc.account_id\n                , da.pd_user_account_name as Account_Name\n                , da.pd_user_user_name as Username\n                , split_part(da.pd_user_user_name,'@',2) as Account_Domain\n                --, fc.end_customer_contact as End_User\n                , CASE fc.channel\t  WHEN 'whatsapp' THEN 'WHATSAPP'     \n                                    WHEN 'messenger' THEN 'MESSENGER'     \n                                    WHEN 'twitter' THEN 'TWITTER'     \n                                    else fc.channel \n                  END as Channel\n                , CASE fc.content_type WHEN 'TEMPLATE' THEN 'TEMPLATE' ELSE 'SESSION' END AS message_type\n                , fc.comm_direction AS Direction\n                , fc.product\n                , nvl(COUNT(fc.record_id), 0) AS Message_Count\n                , count(distinct fc.end_customer_contact) as End_User\nfrom \t\t        \"verticadb\".\"standard\".\"fact_conversation\" as fc \n----------------\nleft join \t    \"verticadb\".\"standard\".\"dim_accounts\" as da \non \t\t\t        fc.account_id =da.account_nk  \n----------------\nleft join \t    \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\" as lm\non \t\t\t        fc.account_id =lm.UC_Account_ID_L0\n----------------\nwhere \t\t      year(fc.created_at) = 2023\n                and month(created_at) > 6\n----------------\ngroup by  \t    1,2,3,4,5,6,7,8,9,10,11\n)select * from \"verticadb\".\"analytics\".\"oy_conversation_messages_2023_H1\"\nunion\nselect * from __dbt__cte__oy_dbt_conversation_messages_append\n  )\n \n\n  \n\n    \n \n  ;\n\n  \n      \n        \n    \n\n      , Message: CommandComplete: command_tag = \"CREATE TABLE\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.conversation.oy_dbt_conversation_messages"}], "elapsed_time": 131.5830590724945, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/oleg/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "no_print": false, "cache_selected_only": false, "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}