{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.4.4", "generated_at": "2023-11-14T13:59:03.952478Z", "invocation_id": "df7d4d5d-23b5-427e-8360-95abb61c97c3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-14T13:58:58.979403Z", "completed_at": "2023-11-14T13:58:58.986131Z"}, {"name": "execute", "started_at": "2023-11-14T13:58:58.986946Z", "completed_at": "2023-11-14T13:59:00.113501Z"}], "thread_id": "Thread-1", "execution_time": 1.1366348266601562, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_accounts_to_ckeck\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_accounts_to_ckeck__dbt_tmp\" include schema privileges as (\n    \n\nwith s as\n(\nselect \t\tdistinct Main_accounts, Subaccounts\nfrom \t\t\"verticadb\".\"analytics\".\"oy_dbt_seed_DASD_50_parent_child_accounts_2\"\n)\n, lm as\n(\nselect distinct UC_Super_Parent_ID, UC_Account_ID_L0, Charging_ID_L0 from \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\"\n)\nselect \t\ts.Main_accounts, s.Subaccounts\n            , lm.Charging_ID_L0\n            , lm1.Charging_ID_L0 as Charging_ID_L0_1\nfrom \t\ts\n------------\nleft join \tlm as lm\non \t\t\ts.Main_accounts = lm.UC_Super_Parent_ID\n------------\nleft join \tlm as lm1\non \t\t\ts.Subaccounts = lm1.UC_Account_ID_L0\n------------\n--where \t\tlm.UC_Account_ID_L0 is null\norder by \ts.Main_accounts\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_accounts_to_ckeck\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_accounts_to_ckeck__dbt_tmp\" include schema privileges as (\n    \n\nwith s as\n(\nselect \t\tdistinct Main_accounts, Subaccounts\nfrom \t\t\"verticadb\".\"analytics\".\"oy_dbt_seed_DASD_50_parent_child_accounts_2\"\n)\n, lm as\n(\nselect distinct UC_Super_Parent_ID, UC_Account_ID_L0, Charging_ID_L0 from \"verticadb\".\"analytics\".\"lm_v_master_account_mapping\"\n)\nselect \t\ts.Main_accounts, s.Subaccounts\n            , lm.Charging_ID_L0\n            , lm1.Charging_ID_L0 as Charging_ID_L0_1\nfrom \t\ts\n------------\nleft join \tlm as lm\non \t\t\ts.Main_accounts = lm.UC_Super_Parent_ID\n------------\nleft join \tlm as lm1\non \t\t\ts.Subaccounts = lm1.UC_Account_ID_L0\n------------\n--where \t\tlm.UC_Account_ID_L0 is null\norder by \ts.Main_accounts\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.DASD_51.oy_dbt_accounts_to_ckeck"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-14T13:59:00.120169Z", "completed_at": "2023-11-14T13:59:00.124096Z"}, {"name": "execute", "started_at": "2023-11-14T13:59:00.124695Z", "completed_at": "2023-11-14T13:59:01.222676Z"}], "thread_id": "Thread-1", "execution_time": 1.1048429012298584, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_days_since_last_consumption\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_days_since_last_consumption__dbt_tmp\" include schema privileges as (\n    \n\nwith base as\n(\nselect      * \nfrom        \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg\" \nwhere       units <> 0\n)\n, ca as\n(\nselect \t\tcharging_id \n\t\t\t, '2023-10-31'::DATE as report_date\n\t\t\t--, current_date as report_date\n\t\t\t, max(date_nk) as last_date_of_consumption\nfrom \t\tbase\nwhere \t\tdate_nk <= report_date\ngroup by \t1,2\n)\nselect \t\tcharging_id\n\t\t\t, last_date_of_consumption\n\t\t\t, report_date\n\t\t\t, DATEDIFF(DAY, last_date_of_consumption, report_date) as days_since_last_consumption\nfrom \t\tca\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_days_since_last_consumption\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_days_since_last_consumption__dbt_tmp\" include schema privileges as (\n    \n\nwith base as\n(\nselect      * \nfrom        \"verticadb\".\"analytics\".\"oy_dbt_consumption_agg\" \nwhere       units <> 0\n)\n, ca as\n(\nselect \t\tcharging_id \n\t\t\t, '2023-10-31'::DATE as report_date\n\t\t\t--, current_date as report_date\n\t\t\t, max(date_nk) as last_date_of_consumption\nfrom \t\tbase\nwhere \t\tdate_nk <= report_date\ngroup by \t1,2\n)\nselect \t\tcharging_id\n\t\t\t, last_date_of_consumption\n\t\t\t, report_date\n\t\t\t, DATEDIFF(DAY, last_date_of_consumption, report_date) as days_since_last_consumption\nfrom \t\tca\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.DASD_51.oy_dbt_days_since_last_consumption"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-14T13:59:01.228232Z", "completed_at": "2023-11-14T13:59:01.233444Z"}, {"name": "execute", "started_at": "2023-11-14T13:59:01.234370Z", "completed_at": "2023-11-14T13:59:02.399007Z"}], "thread_id": "Thread-1", "execution_time": 1.1731090545654297, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_merge\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_merge__dbt_tmp\" include schema privileges as (\n    \n\nwith base as\n(\nselect          a.*\n                , d.report_date\n                , d.last_date_of_consumption\n                , d.days_since_last_consumption\n                \nfrom            \"verticadb\".\"analytics\".\"oy_dbt_accounts_to_ckeck\" as a\n----------------\nleft join       \"verticadb\".\"analytics\".\"oy_dbt_days_since_last_consumption\" as d\non              a.Charging_ID_L0 = d.charging_id\n----------------\n\n)\nselect          *\n                --, CASE when last_date_of_consumption >= last_date_of_consumption_1 then last_date_of_consumption else last_date_of_consumption_1 end as last_date_of_consumption\n                --, CASE when last_date_of_consumption >= last_date_of_consumption_1 then days_since_last_consumption else days_since_last_consumption_1 end as days_since_last_consumption\n                , case when days_since_last_consumption <= 30 then 1 else 0 end as consumption_last_30_days_flag\nfrom            base\norder by        Main_accounts\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_merge\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_merge__dbt_tmp\" include schema privileges as (\n    \n\nwith base as\n(\nselect          a.*\n                , d.report_date\n                , d.last_date_of_consumption\n                , d.days_since_last_consumption\n                \nfrom            \"verticadb\".\"analytics\".\"oy_dbt_accounts_to_ckeck\" as a\n----------------\nleft join       \"verticadb\".\"analytics\".\"oy_dbt_days_since_last_consumption\" as d\non              a.Charging_ID_L0 = d.charging_id\n----------------\n\n)\nselect          *\n                --, CASE when last_date_of_consumption >= last_date_of_consumption_1 then last_date_of_consumption else last_date_of_consumption_1 end as last_date_of_consumption\n                --, CASE when last_date_of_consumption >= last_date_of_consumption_1 then days_since_last_consumption else days_since_last_consumption_1 end as days_since_last_consumption\n                , case when days_since_last_consumption <= 30 then 1 else 0 end as consumption_last_30_days_flag\nfrom            base\norder by        Main_accounts\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.DASD_51.oy_dbt_merge"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-11-14T13:59:02.404626Z", "completed_at": "2023-11-14T13:59:02.408044Z"}, {"name": "execute", "started_at": "2023-11-14T13:59:02.408657Z", "completed_at": "2023-11-14T13:59:03.449010Z"}], "thread_id": "Thread-1", "execution_time": 1.0467209815979004, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_DASD_51\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_DASD_51__dbt_tmp\" include schema privileges as (\n    select          Main_accounts\n                , MAX(consumption_last_30_days_flag) as consumption_last_30_days_flag\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_merge\"\ngroup by        1\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"DASD_51\", \"target_name\": \"dev\", \"node_id\": \"model.DASD_51.oy_dbt_DASD_51\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_DASD_51__dbt_tmp\" include schema privileges as (\n    select          Main_accounts\n                , MAX(consumption_last_30_days_flag) as consumption_last_30_days_flag\nfrom            \"verticadb\".\"analytics\".\"oy_dbt_merge\"\ngroup by        1\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.DASD_51.oy_dbt_DASD_51"}], "elapsed_time": 7.081067085266113, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/oleg/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "no_print": false, "cache_selected_only": false, "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}