{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v4.json", "dbt_version": "1.4.4", "generated_at": "2023-10-29T19:27:33.449747Z", "invocation_id": "b6ae90e8-9c51-49c0-9fca-284e3367a58e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:27:30.953477Z", "completed_at": "2023-10-29T19:27:30.958470Z"}, {"name": "execute", "started_at": "2023-10-29T19:27:30.959333Z", "completed_at": "2023-10-29T19:27:32.036525Z"}], "thread_id": "Thread-1", "execution_time": 1.0854310989379883, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"COGS\", \"target_name\": \"dev\", \"node_id\": \"model.COGS.oy_dbt_cost_update_Dyana_B\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_cost_update_Dyana_B__dbt_tmp\" include schema privileges as (\n    with r as\n(\nselect \t\t\tdistinct\n\t\t\t\tcountry_id||'/'||operator_id||'/'||network_name as cost_id\n\t\t\t\t, country_id, operator_id, network_name , price, currency\n\t\t\t\t, case  when currency='USD' then price::NUMERIC\n                        when currency='SAR' then price::NUMERIC/3.75\n                        when currency='AED' then price::NUMERIC/3.67\n                        end as cost_rate_USD\n\t\t\t\t, effective_date as effective_from\nfrom \t\t\t\"verticadb\".\"raw\".\"mprocra__abl_operator_prices\"\nwhere \t\t\ttype_of_route <> 'INTERNATIONAL'\norder by \t\tcost_id \n)\n, lead as \n(\nselect \t\t\tDENSE_RANK() over (order by cost_id) as drnk\n\t\t\t\t, count(cost_id) over (partition by cost_id) as cnt\n\t\t\t\t, *\n\t\t\t\t, lead(effective_from, 1) over (partition by cost_id order by effective_from) as effective_to\nfrom \t\t\tr\n)\nselect \t\t\t*\n\t\t\t\t, case when effective_to is null then current_date+1 else effective_to end as effective_to_var\nfrom \t\t\tlead\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"COGS\", \"target_name\": \"dev\", \"node_id\": \"model.COGS.oy_dbt_cost_update_Dyana_B\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_cost_update_Dyana_B__dbt_tmp\" include schema privileges as (\n    with r as\n(\nselect \t\t\tdistinct\n\t\t\t\tcountry_id||'/'||operator_id||'/'||network_name as cost_id\n\t\t\t\t, country_id, operator_id, network_name , price, currency\n\t\t\t\t, case  when currency='USD' then price::NUMERIC\n                        when currency='SAR' then price::NUMERIC/3.75\n                        when currency='AED' then price::NUMERIC/3.67\n                        end as cost_rate_USD\n\t\t\t\t, effective_date as effective_from\nfrom \t\t\t\"verticadb\".\"raw\".\"mprocra__abl_operator_prices\"\nwhere \t\t\ttype_of_route <> 'INTERNATIONAL'\norder by \t\tcost_id \n)\n, lead as \n(\nselect \t\t\tDENSE_RANK() over (order by cost_id) as drnk\n\t\t\t\t, count(cost_id) over (partition by cost_id) as cnt\n\t\t\t\t, *\n\t\t\t\t, lead(effective_from, 1) over (partition by cost_id order by effective_from) as effective_to\nfrom \t\t\tr\n)\nselect \t\t\t*\n\t\t\t\t, case when effective_to is null then current_date+1 else effective_to end as effective_to_var\nfrom \t\t\tlead\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.COGS.oy_dbt_cost_update_Dyana_B"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-10-29T19:27:32.043539Z", "completed_at": "2023-10-29T19:27:32.051094Z"}, {"name": "execute", "started_at": "2023-10-29T19:27:32.051872Z", "completed_at": "2023-10-29T19:27:32.946925Z"}], "thread_id": "Thread-1", "execution_time": 0.9057290554046631, "adapter_response": {"_message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"COGS\", \"target_name\": \"dev\", \"node_id\": \"model.COGS.oy_dbt_KSA_COGS_excl_failover\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_KSA_COGS_excl_failover__dbt_tmp\" include schema privileges as (\n    \n\nselect \t\t    t.*\n                , p.price as cost_rate\n                , p.currency\n                , p.cost_rate_USD\n                , t.units*p.price as COGS\n                , t.units*p.cost_rate_USD as COGS_USD\nfrom \t\t    \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg_KSA\" as t \n----------------\nleft join \t    \"verticadb\".\"analytics\".\"oy_dbt_cost_update_Dyana_B\" as p\non \t\t\t    t.cost_id = p.cost_id \n                and t.date_nk >= p.effective_from \n                and t.date_nk < p.effective_to_var\n----------------\nwhere\t\t    1=1\n                and t.date_nk >= '2023-08-01'\n                and p.price is not null -- exluding failovers\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "code": "None", "rows_affected": -1}, "message": "Operation: /* {\"app\": \"dbt\", \"dbt_version\": \"1.4.4\", \"profile_name\": \"COGS\", \"target_name\": \"dev\", \"node_id\": \"model.COGS.oy_dbt_KSA_COGS_excl_failover\"} */\n\n  create view \"verticadb\".\"analytics\".\"oy_dbt_KSA_COGS_excl_failover__dbt_tmp\" include schema privileges as (\n    \n\nselect \t\t    t.*\n                , p.price as cost_rate\n                , p.currency\n                , p.cost_rate_USD\n                , t.units*p.price as COGS\n                , t.units*p.cost_rate_USD as COGS_USD\nfrom \t\t    \"verticadb\".\"analytics\".\"oy_dbt_traffic_operator_agg_KSA\" as t \n----------------\nleft join \t    \"verticadb\".\"analytics\".\"oy_dbt_cost_update_Dyana_B\" as p\non \t\t\t    t.cost_id = p.cost_id \n                and t.date_nk >= p.effective_from \n                and t.date_nk < p.effective_to_var\n----------------\nwhere\t\t    1=1\n                and t.date_nk >= '2023-08-01'\n                and p.price is not null -- exluding failovers\n  );, Message: CommandComplete: command_tag = \"CREATE VIEW\", Code: None, Rows: -1, Arraysize: 1", "failures": null, "unique_id": "model.COGS.oy_dbt_KSA_COGS_excl_failover"}], "elapsed_time": 4.185848951339722, "args": {"write_json": true, "use_colors": true, "printer_width": 80, "version_check": true, "partial_parse": true, "static_parser": true, "profiles_dir": "/Users/oleg/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "no_print": false, "cache_selected_only": false, "which": "run", "rpc_method": "run", "indirect_selection": "eager"}}